2024-06-13 11:31:25.438279: I tensorflow/core/util/port.cc:111] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-06-13 11:31:25.489234: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-06-13 11:31:25.489282: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-06-13 11:31:25.489349: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-06-13 11:31:25.505460: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-13 11:31:26.806989: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
INFO:Logging has been correctly set up
2024-06-13 11:31:33.246986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1886] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 30963 MB memory:  -> device: 0, name: Tesla V100-PCIE-32GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2024-06-13 11:31:33.248518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1886] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 30963 MB memory:  -> device: 1, name: Tesla V100-PCIE-32GB, pci bus id: 0000:af:00.0, compute capability: 7.0
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
INFO:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
INFO:Number of devices: 2
INFO:Loading data:
INFO:  For a large dataset, this may take a while...
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/dl1_data_handler/reader.py:1215: PerformanceWarning: 
your performance may suffer as PyTables will pickle object types that it cannot
map directly to c-types [inferred_type->mixed-integer,key->axis0] [items->None]

  pd.DataFrame(
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/dl1_data_handler/reader.py:1215: PerformanceWarning: 
your performance may suffer as PyTables will pickle object types that it cannot
map directly to c-types [inferred_type->mixed-integer,key->block0_items] [items->None]

  pd.DataFrame(
INFO:  Number of events loaded: 2437297
INFO:Setting up model:
INFO:  Constructing model from config.
INFO:  Model has been correctly set up from config.
INFO:  Compiling model.
INFO:Setting up training:
INFO:  Validation split: 0.1
INFO:  Number of epochs: 15
INFO:  Size of the batches per worker: 24
INFO:  Size of the batches: 48
INFO:  Number of training steps per epoch: 45699
INFO:  Optimizer: Adam
INFO:  Learning rate: 0.0001
INFO:  Learning rate reducing patience: 5
INFO:  Learning rate reducing factor: 0.5
INFO:  Learning rate reducing min delta: 0.01
INFO:  Learning rate reducing min lr: 1e-05
INFO:  Verbosity mode: 2
INFO:  Number of workers: 1
INFO:  Use of multiprocessing: False
INFO:  Apply class weights:
INFO:    Total number: 2437297
INFO:    Breakdown by 'gamma' (0) with original particle id '0': 1061475
INFO:    Breakdown by 'proton' (1) with original particle id '101': 1375822
INFO:    Class weights: {0: 1.1480708448149979, 1: 0.8857602945729899}
INFO:Training and evaluating...
INFO:tensorflow:Collective all_reduce tensors: 146 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
INFO:Collective all_reduce tensors: 146 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Collective all_reduce tensors: 146 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
INFO:Collective all_reduce tensors: 146 all_reduces, num_devices = 2, group_size = 2, implementation = CommunicationImplementation.NCCL, num_packs = 1
2024-06-13 11:32:51.195203: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:442] Loaded cuDNN version 8902
2024-06-13 11:32:53.453150: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:442] Loaded cuDNN version 8902
2024-06-13 11:33:07.735982: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b8476cbf6a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2024-06-13 11:33:07.736048: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-PCIE-32GB, Compute Capability 7.0
2024-06-13 11:33:07.736061: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): Tesla V100-PCIE-32GB, Compute Capability 7.0
2024-06-13 11:33:07.742079: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2024-06-13 11:33:08.002958: I ./tensorflow/compiler/jit/device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
INFO:tensorflow:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:tensorflow:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:tensorflow:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:tensorflow:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:tensorflow:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:tensorflow:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:tensorflow:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:tensorflow:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:tensorflow:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:Assets written to: /home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/assets
INFO:Training and evaluating finished succesfully!
INFO:Plotting training history: accuracy
INFO:Plotting training history: auc
INFO:Plotting training history: loss
Closing remaining open files:/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs2071-2120.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs626-750.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/GammaDiffuse/dec_2276/theta_16.087_az_108.090/gamma_theta_16.087_az_108.090_runs423-482.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1621-1670.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/GammaDiffuse/dec_2276/theta_16.087_az_108.090/gamma_theta_16.087_az_108.090_runs303-362.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs2221-2271.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/GammaDiffuse/dec_2276/theta_16.087_az_108.090/gamma_theta_16.087_az_108.090_runs123-182.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/GammaDiffuse/dec_2276/theta_16.087_az_108.090/gamma_theta_16.087_az_108.090_runs1-62.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1126-1250.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs125-249.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1302-1351.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1-124.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1352-1401.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1521-1570.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/GammaDiffuse/dec_2276/theta_16.087_az_108.090/gamma_theta_16.087_az_108.090_runs183-242.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1671-1720.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1821-1870.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1971-2020.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs2121-2170.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs2272-2321.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs375-499.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs876-1000.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/GammaDiffuse/dec_2276/theta_16.087_az_108.090/gamma_theta_16.087_az_108.090_runs363-422.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs2426-2474.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/GammaDiffuse/dec_2276/theta_16.087_az_108.090/gamma_theta_16.087_az_108.090_runs542-600.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/GammaDiffuse/dec_2276/theta_16.087_az_108.090/gamma_theta_16.087_az_108.090_runs483-541.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1771-1820.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1921-1970.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1251-1301.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1571-1620.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1001-1125.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1402-1456.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1721-1770.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1871-1920.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs2021-2070.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs2171-2220.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs2322-2370.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs2475-2540.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs500-625.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/GammaDiffuse/dec_2276/theta_16.087_az_108.090/gamma_theta_16.087_az_108.090_runs243-302.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs751-875.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs2371-2425.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs250-374.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/GammaDiffuse/dec_2276/theta_16.087_az_108.090/gamma_theta_16.087_az_108.090_runs63-122.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TrainingDataset/Protons/dec_2276/theta_16.087_az_108.090/proton_theta_16.087_az_108.090_runs1457-1520.r1.dl1.h5...done
