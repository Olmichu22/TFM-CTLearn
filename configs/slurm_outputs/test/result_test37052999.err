2024-07-03 17:43:08.301899: I tensorflow/core/util/port.cc:111] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-03 17:43:08.356486: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-07-03 17:43:08.356534: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-07-03 17:43:08.356602: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-07-03 17:43:08.373517: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-03 17:43:15.512718: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
INFO:Logging has been correctly set up
2024-07-03 17:43:35.251477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1886] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 30963 MB memory:  -> device: 0, name: Tesla V100-PCIE-32GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2024-07-03 17:43:35.253124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1886] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 30963 MB memory:  -> device: 1, name: Tesla V100-PCIE-32GB, pci bus id: 0000:af:00.0, compute capability: 7.0
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
INFO:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
INFO:Number of devices: 2
INFO:Loading data:
INFO:  For a large dataset, this may take a while...
INFO:  Number of events loaded: 3023659
INFO:  Simulation info for pyirf.simulations.SimulatedEventsInfo: {'n_showers': 100000000.0, 'energy_range_min': 0.005, 'energy_range_max': 51.951, 'max_scatter_range': 710.8, 'spectral_index': -2.0, 'min_viewcone_radius': 0.3999, 'max_viewcone_radius': 0.4001, 'min_alt': 1.3962634, 'max_alt': 1.3962634}
INFO:Setting up model:
INFO:  Constructing model from config.
INFO:  Loading weights from '/home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/'.
INFO:  Model has been correctly set up from config.
INFO:  Compiling model.
INFO:Predicting...
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/dl1_data_handler/reader.py:448: RuntimeWarning: Mean of empty slice.
  vector[:, i] = record["peak_time"] - cleaned_peak_times[np.nonzero(cleaned_peak_times)].mean()
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/numpy/core/_methods.py:190: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/keras/src/engine/functional.py:642: UserWarning: Input dict contained keys ['parameters'] which did not match any model input. They will be ignored by the model.
  inputs = self._flatten_to_reference_inputs(inputs)
2024-07-03 17:45:19.539374: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:442] Loaded cuDNN version 8902
2024-07-03 17:45:54.097908: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:442] Loaded cuDNN version 8902
INFO:Logging has been correctly set up
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
INFO:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
INFO:Number of devices: 2
INFO:Loading data:
INFO:  For a large dataset, this may take a while...
INFO:  Number of events loaded: 3019091
INFO:  Simulation info for pyirf.simulations.SimulatedEventsInfo: {'n_showers': 100000000.0, 'energy_range_min': 0.005, 'energy_range_max': 51.951, 'max_scatter_range': 710.8, 'spectral_index': -2.0, 'min_viewcone_radius': 0.3999, 'max_viewcone_radius': 0.4001, 'min_alt': 1.3962634, 'max_alt': 1.3962634}
INFO:Setting up model:
INFO:  Constructing model from config.
INFO:  Loading weights from '/home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/'.
INFO:  Model has been correctly set up from config.
INFO:  Compiling model.
INFO:Predicting...
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/dl1_data_handler/reader.py:448: RuntimeWarning: Mean of empty slice.
  vector[:, i] = record["peak_time"] - cleaned_peak_times[np.nonzero(cleaned_peak_times)].mean()
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/numpy/core/_methods.py:190: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/keras/src/engine/functional.py:642: UserWarning: Input dict contained keys ['parameters'] which did not match any model input. They will be ignored by the model.
  inputs = self._flatten_to_reference_inputs(inputs)
INFO:Logging has been correctly set up
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
INFO:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
INFO:Number of devices: 2
INFO:Loading data:
INFO:  For a large dataset, this may take a while...
INFO:  Number of events loaded: 211477
INFO:  Simulation info for pyirf.simulations.SimulatedEventsInfo: {'n_showers': 499600000.0, 'energy_range_min': 0.01, 'energy_range_max': 103.901, 'max_scatter_range': 1511.53, 'spectral_index': -2.0, 'min_viewcone_radius': 0.0, 'max_viewcone_radius': 9.0, 'min_alt': 1.3962634, 'max_alt': 1.3962634}
INFO:Setting up model:
INFO:  Constructing model from config.
INFO:  Loading weights from '/home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/'.
INFO:  Model has been correctly set up from config.
INFO:  Compiling model.
INFO:Predicting...
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/dl1_data_handler/reader.py:448: RuntimeWarning: Mean of empty slice.
  vector[:, i] = record["peak_time"] - cleaned_peak_times[np.nonzero(cleaned_peak_times)].mean()
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/numpy/core/_methods.py:190: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/keras/src/engine/functional.py:642: UserWarning: Input dict contained keys ['parameters'] which did not match any model input. They will be ignored by the model.
  inputs = self._flatten_to_reference_inputs(inputs)
INFO:Logging has been correctly set up
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
INFO:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1')
INFO:Number of devices: 2
INFO:Loading data:
INFO:  For a large dataset, this may take a while...
INFO:  Number of events loaded: 42188
INFO:  Simulation info for pyirf.simulations.SimulatedEventsInfo: {'n_showers': 99800000.0, 'energy_range_min': 0.01, 'energy_range_max': 103.901, 'max_scatter_range': 1511.53, 'spectral_index': -2.0, 'min_viewcone_radius': 0.0, 'max_viewcone_radius': 9.0, 'min_alt': 1.3962634, 'max_alt': 1.3962634}
INFO:Setting up model:
INFO:  Constructing model from config.
INFO:  Loading weights from '/home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//ctlearn_model/'.
INFO:  Model has been correctly set up from config.
INFO:  Compiling model.
INFO:Predicting...
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/dl1_data_handler/reader.py:448: RuntimeWarning: Mean of empty slice.
  vector[:, i] = record["peak_time"] - cleaned_peak_times[np.nonzero(cleaned_peak_times)].mean()
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/numpy/core/_methods.py:190: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
/home/olmo.arqueropeinazo/miniconda3/envs/ctlearn-cluster/lib/python3.10/site-packages/keras/src/engine/functional.py:642: UserWarning: Input dict contained keys ['parameters'] which did not match any model input. They will be ignored by the model.
  inputs = self._flatten_to_reference_inputs(inputs)
Closing remaining open files:/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs102-151.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_102.199_/gamma_theta_10.0_az_102.199_runs251-300.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_248.117_/proton_theta_10.0_az_248.117_runs1-51.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_102.199_/gamma_theta_10.0_az_102.199_runs1-50.r1.dl1.h5...done/home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//example_identifiers_file.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_102.199_/gamma_theta_10.0_az_102.199_runs101-150.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_102.199_/gamma_theta_10.0_az_102.199_runs401-450.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs551-600.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs51-101.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_248.117_/gamma_theta_10.0_az_248.117_runs451-500.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs1-50.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs302-351.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_248.117_/gamma_theta_10.0_az_248.117_runs201-250.r1.dl1.h5...done/home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//example_identifiers_file.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs352-401.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_248.117_/gamma_theta_10.0_az_248.117_runs101-150.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_102.199_/gamma_theta_10.0_az_102.199_runs151-200.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_102.199_/gamma_theta_10.0_az_102.199_runs51-100.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_102.199_/gamma_theta_10.0_az_102.199_runs301-350.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_248.117_/proton_theta_10.0_az_248.117_runs102-151.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_248.117_/proton_theta_10.0_az_248.117_runs252-301.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_102.199_/gamma_theta_10.0_az_102.199_runs451-500.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_248.117_/proton_theta_10.0_az_248.117_runs352-401.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs252-301.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_248.117_/proton_theta_10.0_az_248.117_runs302-351.r1.dl1.h5...done/home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//example_identifiers_file.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_248.117_/proton_theta_10.0_az_248.117_runs52-101.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_248.117_/gamma_theta_10.0_az_248.117_runs351-400.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs451-500.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_248.117_/proton_theta_10.0_az_248.117_runs402-451.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs501-550.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs601-650.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_248.117_/gamma_theta_10.0_az_248.117_runs51-100.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs651-700.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs701-750.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_102.199_/gamma_theta_10.0_az_102.199_runs201-250.r1.dl1.h5...done/home/olmo.arqueropeinazo/data/temp/logs/trial_complete_data//example_identifiers_file.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs402-450.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_248.117_/gamma_theta_10.0_az_248.117_runs251-300.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_248.117_/proton_theta_10.0_az_248.117_runs152-201.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_248.117_/gamma_theta_10.0_az_248.117_runs301-350.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_102.199_/gamma_theta_10.0_az_102.199_runs351-400.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_248.117_/proton_theta_10.0_az_248.117_runs202-251.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_248.117_/gamma_theta_10.0_az_248.117_runs401-450.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_248.117_/proton_theta_10.0_az_248.117_runs452-500.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_248.117_/gamma_theta_10.0_az_248.117_runs1-50.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs202-251.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Gammas/node_corsika_theta_10.0_az_248.117_/gamma_theta_10.0_az_248.117_runs151-200.r1.dl1.h5...done/fefs/aswg/workspace/tjark.miener/DeepCrab/R1DL1/LSTProd2/TestDataset/Protons/node_corsika_theta_10.0_az_102.199_/proton_theta_10.0_az_102.199_runs152-201.r1.dl1.h5...done
